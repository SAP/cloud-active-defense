[
    {
    "decoy": {
        "key": "dummy",
        "string": "OK"
    },
    "inject": {
        "store": {
        "inResponse": "api[\/]?$",
        "withVerb": "POST",
        "as": "body",
        "at": {
            "method": "replace",
            "property": "((.|\n)*)"
        },
        "whenTrue": [
            {
            "key": "SESSION",
            "value": ".*",
            "in": "cookie"
            }
        ]
        }
    }
    },
    {
    "decoy": {
        "key": "200"
    },
    "inject": {
        "store": {
        "inResponse": "api[\/]?$",
        "withVerb": "POST",
        "as": "status",
        "at": {
            "method": "replace",
            "property": "((.|\n)*)"
        },
        "whenTrue": [
            {
            "key": "SESSION",
            "value": ".*",
            "in": "cookie"
            }
        ]
        }
    }
    },
    
    {
    "decoy": {
        "key": "dummy",
        "string": "OK"
    },
    "inject": {
        "store": {
        "inResponse": "api\/admin[\/]?$",
        "withVerb": "POST",
        "as": "body",
        "at": {
            "method": "replace",
            "property": "((.|\n)*)"
        },
        "whenTrue": [
            {
            "key": "SESSION",
            "value": ".*",
            "in": "cookie"
            }
        ]
        }
    }
    },
    {
    "decoy": {
        "key": "200"
    },
    "inject": {
        "store": {
        "inResponse": "api\/admin[\/]?$",
        "withVerb": "POST",
        "as": "status",
        "at": {
            "method": "replace",
            "property": "((.|\n)*)"
        },
        "whenTrue": [
            {
            "key": "SESSION",
            "value": ".*",
            "in": "cookie"
            }
        ]
        }
    }
    },
    
    {
    "decoy": {
        "key": "dummy",
        "string": "OK"
    },
    "inject": {
        "store": {
        "inResponse": "api\/admin\/user[\/]?$",
        "withVerb": "POST",
        "as": "body",
        "at": {
            "method": "replace",
            "property": "((.|\n)*)"
        },
        "whenTrue": [
            {
            "key": "SESSION",
            "value": ".*",
            "in": "cookie"
            }
        ]
        }
    }
    },
    {
    "decoy": {
        "key": "200"
    },
    "inject": {
        "store": {
        "inResponse": "api\/admin\/user[\/]?$",
        "withVerb": "POST",
        "as": "status",
        "at": {
            "method": "replace",
            "property": "((.|\n)*)"
        },
        "whenTrue": [
            {
            "key": "SESSION",
            "value": ".*",
            "in": "cookie"
            }
        ]
        }
    }
    },
    {
    "decoy": {
        "key": "dummy",
        "string": "OK"
    },
    "inject": {
        "store": {
        "inResponse": "api\/system[\/]?$",
        "withVerb": "POST",
        "as": "body",
        "at": {
            "method": "replace",
            "property": "((.|\n)*)"
        },
        "whenTrue": [
            {
            "key": "SESSION",
            "value": ".*",
            "in": "cookie"
            }
        ]
        }
    }
    },
    {
    "decoy": {
        "key": "200"
    },
    "inject": {
        "store": {
        "inResponse": "api\/system[\/]?$",
        "withVerb": "POST",
        "as": "status",
        "at": {
            "method": "replace",
            "property": "((.|\n)*)"
        },
        "whenTrue": [
            {
            "key": "SESSION",
            "value": ".*",
            "in": "cookie"
            }
        ]
        }
    }
    },
    {
    "decoy": {
        "key": "dummy",
        "string": "OK"
    },
    "inject": {
        "store": {
        "inResponse": "api\/system\/pfp[\/]?$",
        "withVerb": "POST",
        "as": "body",
        "at": {
            "method": "replace",
            "property": "((.|\n)*)"
        },
        "whenTrue": [
            {
            "key": "SESSION",
            "value": ".*",
            "in": "cookie"
            }
        ]
        }
    }
    },
    {
    "decoy": {
        "key": "200"
    },
    "inject": {
        "store": {
        "inResponse": "api\/system\/pfp[\/]?$",
        "withVerb": "POST",
        "as": "status",
        "at": {
            "method": "replace",
            "property": "((.|\n)*)"
        },
        "whenTrue": [
            {
            "key": "SESSION",
            "value": ".*",
            "in": "cookie"
            }
        ]
        }
    }
    },
    {
      "decoy": {
        "dynamicKey": "/api/admin/user/(.+)",
        "string": "Error: unknown id"
      },
      "inject": {
        "store": {
          "inResponse": "api/admin/user/",
          "withVerb": "POST",
          "as": "body",
          "at": {
            "method": "replace",
            "property": "((.|\n)*)"
          },
          "whenTrue": [
            {
              "key": "SESSION",
              "value": ".*",
              "in": "cookie"
            }
          ]
        }
      },
      "detect": {
        "seek": {
          "inRequest": "api/admin/user/",
          "withVerb": "POST",
          "in": "url",
          "whenTrue": [
            {
              "key": "SESSION",
              "value": ".*",
              "in": "cookie"
            }
          ]
        },
        "alert": {
          "severity": "HIGH",
          "whenSeen": true
        }
      }
    },
    {
      "decoy": {
        "dynamicKey": ".*pfpFilename.*\\.\\..*",
        "string": "OK"
      },
      "inject": {
        "store": {
          "inResponse": "api/system/pfp[\/]?$",
          "withVerb": "POST",
          "as": "body",
          "at": {
            "method": "replace",
            "property": "((.|\n)*)"
          },
          "whenTrue": [
            {
              "key": "SESSION",
              "value": ".*",
              "in": "cookie"
            }
          ]
        }
      },
      "detect": {
        "seek": {
          "inRequest": "api/system/pfp[\/]?$",
          "withVerb": "POST",
          "in": "payload"
        },
        "alert": {
          "severity": "HIGH",
          "whenSeen": true
        }
      }
    },
    {
    "decoy": {
        "key": "/api/admin"
    },
    "detect": {
        "seek": {
        "inRequest": ".*",
        "withVerb": "POST",
        "in": "url",
        "whenTrue": [
            {
            "key": "SESSION",
            "value": ".*",
            "in": "cookie"
            }
        ]
        },
        "alert": {
        "severity": "HIGH",
        "whenSeen": true
        }
    }
    }
]